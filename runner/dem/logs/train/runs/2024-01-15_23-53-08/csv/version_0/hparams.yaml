model:
  net:
    _target_: src.models.components.mlp.MyMLP
    _partial_: true
    hidden_size: 128
    hidden_layers: 3
    emb_size: 128
    time_emb: sinusoidal
    input_emb: sinusoidal
  _target_: src.models.dem_module.DEMLitModule
  optimizer:
    _target_: torch.optim.Adam
    _partial_: true
    lr: 0.001
    weight_decay: 0.0
  scheduler:
    _target_: torch.optim.lr_scheduler.ReduceLROnPlateau
    _partial_: true
    mode: min
    factor: 0.1
    patience: 10
  buffer:
    _target_: src.models.components.prioritised_replay_buffer.SimpleBuffer
    dim: ${energy.dimensionality}
    max_length: 10000
    min_sample_length: 1000
    initial_sampler: null
    device: ${trainer.accelerator}
    sample_with_replacement: true
    fill_buffer_during_init: false
    prioritize: false
  score_scaler: null
  num_init_samples: 1024
  num_estimator_mc_samples: 100
  num_samples_to_generate_per_epoch: 1000
  num_samples_to_sample_from_buffer: 512
  num_integration_steps: 1000
  nll_integration_method: euler
  nll_with_cfm: true
  nll_with_dem: false
  cfm_sigma: 0.0
  cfm_prior_std: ${energy.data_normalization_factor}
  use_otcfm: false
  prioritize_cfm_training_samples: false
  lr_scheduler_update_frequency: ${trainer.check_val_every_n_epoch}
  input_scaling_factor: null
  output_scaling_factor: null
  compile: false
  cfm_loss_weight: 1.0
  use_ema: false
  debug_use_train_data: false
  init_from_prior: false
  noise_schedule:
    _target_: src.models.components.noise_schedules.GeometricNoiseSchedule
    sigma_min: 4.0e-06
    sigma_max: 0.4
  partial_prior:
    _target_: src.energies.base_prior.Prior
    _partial_: true
    dim: 2
  clipper:
    _target_: src.models.components.clipper.Clipper
    should_clip_scores: true
    should_clip_log_rewards: false
    max_score_norm: 50
    min_log_reward: null
  lambda_weighter:
    _target_: src.models.components.lambda_weighter.BasicLambdaWeighter
    _partial_: true
    epsilon: 0.001
  diffusion_scale: 1.0
model/params/total: 198148
model/params/trainable: 198148
model/params/non_trainable: 0
data:
  _target_: src.data.dummy.DummyDataModule
  n_train_batches_per_epoch: 100
  n_val_batches_per_epoch: 1
  n_test_batches_per_epoch: 1
trainer:
  _target_: lightning.pytorch.trainer.Trainer
  default_root_dir: ${paths.output_dir}
  min_epochs: 1
  max_epochs: 1000
  accelerator: cuda
  devices: 1
  check_val_every_n_epoch: 10
  deterministic: false
callbacks:
  model_summary:
    _target_: lightning.pytorch.callbacks.RichModelSummary
    max_depth: -1
  rich_progress_bar:
    _target_: lightning.pytorch.callbacks.RichProgressBar
  model_checkpoint:
    dirpath: ${paths.output_dir}/checkpoints
    filename: epoch_{epoch:03d}
    monitor: val/nll
    mode: min
    save_last: true
    save_top_k: 3
    auto_insert_metric_name: false
extras:
  ignore_warnings: false
  enforce_tags: true
  print_config: true
task_name: train
tags:
- GMM
ckpt_path: null
seed: 12345
